path <- "C:/Users/Usuario/Documents/cursos/Data Analysis/hackathons/student hunt"
setwd(path)
train <- read.csv("train.csv",stringsAsFactors = F)
test <- read.csv("test.csv",stringsAsFactors = F)
library(dplyr)
train <- train[80177:114539,]
test <- test[27594:39420,]
table(is.na(train))
prop.table(table(is.na(train)))
prop.table(as.data.frame(colSums(is.na(train))))
colSums(is.na(train))
str(train)
#PLOT
library(ggplot2)
library(gridExtra)
names(train)
hist(train$Direction_Of_Wind)
hist(train$Average_Atmospheric_Pressure)
ggplot(train,aes(x=Date,y=Footfall))+geom_point()
ggplot(train,aes(x=Location_Type,y=Footfall))+geom_bar(stat = "identity")
plot(train$Direction_Of_Wind, train$Footfall)
ggplot(train,aes(x=Park_ID,y=Footfall))+geom_bar(stat = "identity")
qplot(Location_Type,Footfall,data = train)
qplot(Average_Atmospheric_Pressure,Footfall,data = train)
qplot(Average_Moisture_In_Park,Footfall,data = train)
library(RColorBrewer)
hist(train$Min_Atmospheric_Pressure,breaks=10,col=brewer.pal(9,"Blues"))
hist(train$Max_Atmospheric_Pressure,breaks=10,col=brewer.pal(9,"Blues"))
barplot(table(train$Location_Type,train$Footfall),col=brewer.pal(4,"Set1"),legend.text = T)
barplot(table(train$Var1,train$Footfall),col=brewer.pal(9,"Set1"),legend.text = T)
plot(x=train$Max_Breeze_Speed,y=train$Footfall)
hist(train$Max_Breeze_Speed)
plot(train,col=brewer.pal(9,"Blues"))
test$Footfall<- 1
total <- rbind(train,test)
library(VIM)
aggr_plot <- aggr(total, col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(total), cex.axis=.5, gap=1, ylab=c("Histogram of missing data","Pattern"))
marginplot(total[c(11,10)])
